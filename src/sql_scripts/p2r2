select COURSE_NAME, cnt
from
(
select distinct COURSE_NAME, STUDENT_POPULATION_CODE_REF, count(*) as cnt from ATTENDANCE
join COURSES on COURSE_CODE = ATTENDANCE_COURSE_REF
join STUDENTS as s on ATTENDANCE_STUDENT_REF = STUDENT_EPITA_EMAIL
where STUDENT_POPULATION_CODE_REF = '{course}' and STUDENT_POPULATION_YEAR_REF = {year} and STUDENT_POPULATION_PERIOD_REF = '{period}'
group by ATTENDANCE_STUDENT_REF, ATTENDANCE_COURSE_REF
)
